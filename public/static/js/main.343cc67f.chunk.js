(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{116:function(e,t,n){},117:function(e,t,n){},119:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),c=n(14),i=n(10),s=n(7),l=n(37),u=n(38),m=n(39),p=n(2),d=n(45),f=n(4),E="ADD_OPERATION",b="FETCH_OPERATIONS",v="REMOVE_OPERATION",O=n(6),h=n.n(O),N=function(e){return"".concat(e.toFixed(2)," \u20bd")},w=function(e){var t;return(t={},Object(p.a)(t,"OPERATION_CREDIT","\u0420\u0430\u0441\u0445\u043e\u0434"),Object(p.a)(t,"OPERATION_DEBIT","\u0414\u043e\u0445\u043e\u0434"),t)[e]||"Unknown operation"},j=function(e){var t;return(t={},Object(p.a)(t,"OPERATION_CREDIT","credit"),Object(p.a)(t,"OPERATION_DEBIT","debit"),t)[e]||null},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.reduce(function(e,t){return"OPERATION_CREDIT"===t.type?e-=t.amount:e+=t.amount},t)},y=function(e,t){return e.type===t.type?e.timestamp-t.timestamp:"OPERATION_CREDIT"===e.type?1:-1},I={balance:0,operations:[]},R=(a={},Object(p.a)(a,b,function(e,t){var n=t.operations,a=e.balance,r=_(n,a);return Object(f.a)({},e,{balance:r,operations:n})}),Object(p.a)(a,E,function(e,t){var n=t.operation,a=[].concat(Object(d.a)(e.operations),[n]),r=e.balance;return Object(f.a)({},e,{operations:a,balance:_([n],r)})}),Object(p.a)(a,v,function(e,t){var n=t.operation,a=e.operations.filter(function(e){return e.id!==n.id});return Object(f.a)({},e,{operations:a,balance:_(a,0)})}),a),g={period:"PERIOD_WEEK"},k=Object(p.a)({},"SET_PERIOD",function(e,t){var n=t.period;return Object(f.a)({},e,{period:n})}),T=Object(m.createLogger)({collapsed:!0}),Y=Object(s.createStore)(Object(s.combineReducers)({operations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;return R[t.type]?R[t.type](e,t):e},filters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;return k[t.type]?k[t.type](e,t):e}}),Object(l.composeWithDevTools)(Object(s.applyMiddleware)(u.a,T))),D=(n(61),n(40)),P=n(41),x=n(46),C=n(42),M=n(47),A=n(9),H=n.n(A),W=n(16),S=n(43),F=n.n(S).a.create({baseURL:"https://personal-accountant.herokuapp.com/"});F.defaults.headers.common["Content-Type"]="application/json; charset=UTF-8";var B=F,K=function(e){var t=e.balance;return o.a.createElement("div",null,o.a.createElement("span",null,"\u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u043e\u0441\u0442\u0430\u0442\u043e\u043a:"),o.a.createElement("strong",null,N(t)))},U=n(48),J=n(21),L=n.n(J),V=n(22);n(94);L.a.setAppElement("#root");var q=function(e){var t=e.show,n=e.dismiss,a=e.proceed,r=(e.cancel,e.component),c=Object(U.a)(e,["show","dismiss","proceed","cancel","component"]);return o.a.createElement(L.a,{isOpen:t,onRequestClose:n,className:"modal-window",overlayClassName:"react-overlay"},o.a.createElement(r,Object.assign({},c,{proceed:a,dismiss:n})))};function $(e,t){return Object(V.createConfirmation)(Object(V.confirmable)(q))(Object(f.a)({component:e},t))}var z=n(12),G=function(e){return e?void 0:"\u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f"},Q=function(e){return isNaN(e)?"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0447\u0438\u0441\u043b\u043e\u043c":void 0},X=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce(function(t,n){return t||n(e)},void 0)}},Z=(n(95),function(e){var t=e.submitHandler,n=e.dismiss,a=void 0===n?null:n,r=["OPERATION_CREDIT","OPERATION_DEBIT"],c={type:"OPERATION_CREDIT",amount:"",description:null};return o.a.createElement(z.b,{onSubmit:function(e,n){t(Object(f.a)({},e,{amount:Number(e.amount),timestamp:(new Date).getTime()})),n.reset(),a&&a()},initialValues:c,render:function(e){var t,n=e.handleSubmit,c=e.form,i=e.submitting,s=e.pristine;return o.a.createElement("form",{className:"operation-form",onSubmit:n},o.a.createElement("div",{className:"operation-form_row"},o.a.createElement("h2",null,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c:")),o.a.createElement("div",{className:"operation-form_row"},o.a.createElement(z.a,{name:"type",component:"select",validate:G},function(e){var t=e.input;return o.a.createElement("label",null,"\u0422\u0438\u043f:",o.a.createElement("select",Object.assign({},t,{id:"type",tabIndex:"1"}),r.map(function(e,t){return o.a.createElement("option",{key:t,value:e},w(e))})))}),"\xa0",o.a.createElement(z.a,{name:"amount",component:"number",validate:X(G,Q,(t=0,function(e){return isNaN(e)||e>=t?void 0:"\u0414\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 ".concat(t)}))},function(e){var t=e.input,n=e.meta;return o.a.createElement("label",null,"\u0421\u0443\u043c\u043c\u0430:",o.a.createElement("input",Object.assign({},t,{id:"amount",type:"number",placeholder:"\u0432 \u0440\u0443\u0431\u043b\u044f\u0445",step:"0.1",min:"0.1",tabIndex:"2"})),n.error&&n.touched&&o.a.createElement("span",{className:"error"},n.error))})),o.a.createElement("div",{className:"operation-form_row"},o.a.createElement(z.a,{id:"description",name:"description",component:"textarea",placeholer:"description"},function(e){var t=e.input;return o.a.createElement("div",{className:"operation-form_row"},o.a.createElement("label",{htmlFor:"description"},"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),o.a.createElement("textarea",Object.assign({},t,{id:"description",cols:"30",rows:"10",tabIndex:"3"})))})),o.a.createElement("div",{className:"operation-form_row"},o.a.createElement("div",{className:"buttons"},o.a.createElement("button",{className:"add",type:"submit",disabled:i||s,tabIndex:"4"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),o.a.createElement("button",{type:"button",onClick:function(){c.reset(),a&&a()},disabled:i,tabIndex:"5"},"\u041e\u0442\u043c\u0435\u043d\u0430"))))}})}),ee=function(e){var t=e.balance,n=e.addOperation;return o.a.createElement(o.a.Fragment,null,o.a.createElement(K,{balance:t}),o.a.createElement("button",{onClick:function(){$(Z,{submitHandler:n})}},"add"))},te={addOperation:function(e){return function(){var t=Object(W.a)(H.a.mark(function t(n){var a;return H.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.post("/operation",e);case 2:if(200===(a=t.sent).status){t.next=6;break}return console.error(a),t.abrupt("return");case 6:n({type:E,operation:e});case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}},ne=Object(i.b)(function(e){return{balance:e.operations.balance}},te)(ee),ae=n(15),re=n(23),oe=function(e){return e.filters.period},ce=Object(re.a)([function(e){return e.operations.operations},oe],function(e,t){switch(t){case"PERIOD_WEEK":return e.reduce(function(e,t){var n=h()(t.timestamp).format("YYYY[W]WW\t");return e[n]=e[n]||[],e[n].push(t),e},{});case"PERIOD_NONE":default:return e}}),ie=Object(re.a)([ce,oe],function(e,t){switch(t){case"PERIOD_WEEK":return Object.entries(e).forEach(function(t){var n=Object(ae.a)(t,2),a=n[0],r=n[1];e[a]=r.sort(y)}),e;case"PERIOD_NONE":default:return e.sort(y)}}),se=(n(96),n(97),function(e){var t=e.operation,n=e.operation,a=n.type,r=n.amount,c=n.description,i=n.timestamp,s=(e.editHandler,e.removeHandler);return o.a.createElement("div",{className:"operation-list_item ".concat(j(a))},o.a.createElement("div",{className:"item_row"},o.a.createElement("span",{className:"type"},o.a.createElement("strong",null,"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u044f: "),w(a)),"\xa0",o.a.createElement("span",{className:"amount"},o.a.createElement("strong",null,"\u0421\u0443\u043c\u043c\u0430: "),N(r))),c?o.a.createElement("div",{className:"item_row"},o.a.createElement("span",{className:"description"},o.a.createElement("strong",null,"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435: "),c)):null,o.a.createElement("div",{className:"item_row controls"},o.a.createElement("small",{onClick:function(){return s(t)},className:"remove"},"\u0443\u0434\u0430\u043b\u0438\u0442\u044c")),o.a.createElement("div",{className:"item_row"},o.a.createElement("small",{className:"time"},h()(i).fromNow(),o.a.createElement("span",{className:"tooltip"},h()(i).format("D MMMM YYYY HH:mm")))))}),le=function(e){var t=e.operations,n=e.handlers;return o.a.createElement("div",{className:"operation-list"},t.length?t.map(function(e,t){return o.a.createElement(se,{key:t,operation:e,editHandler:n.editHandler,removeHandler:n.removeHandler})}):o.a.createElement("div",null,"there is no operations yet..."))},ue=n(44),me=(n(116),function(e){var t=e.operations,n=e.handlers;return o.a.createElement("div",{className:"operation-week"},Object.entries(t).map(function(e){var t=Object(ae.a)(e,2),a=t[0],r=t[1],c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"week",n={week:"D MMMM YYYY",mounth:"MMMM YYYY"},a=h()(e,{week:"YYYY[W]WW",mounth:"YYYY[M]MM"}[t]);return{start:a.startOf(t).format(n[t]),end:a.endOf(t).format(n[t])}}(a,"week");return o.a.createElement("div",{className:"operation-week__item",key:a},o.a.createElement("span",{className:"operation-week__item-label"},"".concat(c.start," - ").concat(c.end)),o.a.createElement(ue.Scrollbars,null,o.a.createElement(le,{operations:r,handlers:n})))}))}),pe=(n(117),function(e){var t=e.proceed,n=e.dismiss;return o.a.createElement("div",{className:"remove-operation"},o.a.createElement("div",{className:"item_row"},o.a.createElement("h3",null,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"),o.a.createElement("span",null,"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u0443 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044e?")),o.a.createElement("div",{className:"item_row"},o.a.createElement("button",{className:"error",onClick:t},"\u0414\u0430"),o.a.createElement("button",{onClick:n},"\u041e\u0442\u043c\u0435\u043d\u0430")))}),de=function(e){var t=e.operations,n=e.filters,a=e.fetchOperations,c=e.removeOperation;Object(r.useEffect)(function(){a()},a);var i={editHandler:function(e){return console.log(e)},removeHandler:function(e){return $(pe).then(function(){return c(e)}).catch(function(){return console.log("\u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043e\u0442\u043c\u0435\u043d\u0435\u043d\u043e")})}};switch(n.period){case"PERIOD_WEEK":return o.a.createElement(me,{operations:t,handlers:i});case"PERIOD_NONE":default:return o.a.createElement(le,{operations:t,handlers:i})}},fe={fetchOperations:function(){return function(){var e=Object(W.a)(H.a.mark(function e(t){var n;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.get("/operation");case 2:if(200===(n=e.sent).status){e.next=6;break}return console.error(n),e.abrupt("return");case 6:t({type:b,operations:n.data});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},removeOperation:function(e){return function(){var t=Object(W.a)(H.a.mark(function t(n){var a;return H.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.delete("/operation/".concat(e.id));case 2:if(204===(a=t.sent).status){t.next=6;break}return console.error(a),t.abrupt("return",!1);case 6:return n({type:v,operation:e}),t.abrupt("return",!0);case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}},Ee=Object(i.b)(function(e){return{operations:ie(e),filters:e.filters}},fe)(de),be=function(e){function t(){return Object(D.a)(this,t),Object(x.a)(this,Object(C.a)(t).apply(this,arguments))}return Object(M.a)(t,e),Object(P.a)(t,[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(ne,null),o.a.createElement(Ee,null))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(118);Object(c.render)(o.a.createElement(i.a,{store:Y},o.a.createElement(be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},49:function(e,t,n){e.exports=n(119)},61:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){}},[[49,1,2]]]);
//# sourceMappingURL=main.343cc67f.chunk.js.map